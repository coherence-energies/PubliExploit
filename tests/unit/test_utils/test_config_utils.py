import unittest
import os
import configparser
from CEpublicationEXPL.src.utils.config_utils import read_config  # Importez correctement la fonction à tester


class TestReadConfig(unittest.TestCase):
    def setUp(self):
        # Chemin vers le fichier de configuration de test
        self.config_file = '/home/ubuntu/CEpublicationEXPL/tests/fixtures/test_config.ini'

    def test_read_config(self):
        # Vérifier que le fichier de configuration existe
        self.assertTrue(os.path.exists(self.config_file), f"Le fichier {self.config_file} n'existe pas.")

        # Lire la configuration depuis le fichier
        config = read_config(self.config_file)

        # Vérifier que la configuration a été correctement parsée
        # (Remplacez les sections et les paramètres par ceux de votre fichier de configuration)
        self.assertEqual(config.get('IMAP', 'server'), 'imap.mail.ovh.net')

        # Vérifier qu'une exception est levée si la section ou le paramètre n'existe pas
        with self.assertRaises(configparser.NoSectionError):
            config.get('section_inexistante', 'param1')
        with self.assertRaises(configparser.NoOptionError):
            config.get('IMAP', 'param_inexistant')

if __name__ == '__main__':
    unittest.main()


# A la racine du serveur, python3 -m unittest CEpublicationEXPL.tests.unit.test_utils.test_config_utils

